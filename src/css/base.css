/* Base Reset and Dark Theme */
*,
*::before,
*::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
  background: #0a0a0f; /* Ensure base dark background */
}

body {
  font-family: var(--font-family-sans);
  font-size: var(--font-size-body-reg);
  line-height: 1.6;
  color: var(--color-text-primary); /* Changed from text-secondary for better visibility */
  background: #0a0a0f; /* Dark base - merged from line 201 */
  overflow-x: hidden;
  position: relative;
}

/* Reduced Motion Support */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  html {
    scroll-behavior: auto;
  }
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  font-weight: var(--font-weight-bold);
  color: var(--color-text-primary);
  line-height: 1.2;
  letter-spacing: -0.02em;
}

h1 { font-size: var(--font-size-h1); }
h2 { font-size: var(--font-size-h2); }
h3 { font-size: var(--font-size-h3); }

.hero-title {
  font-size: clamp(3rem, 8vw, 6rem);
  font-weight: 800;
  letter-spacing: -0.03em;
}

.lead {
  font-size: var(--font-size-body-lg);
  color: var(--color-text-primary);
  margin-bottom: var(--space-4);
}

.gradient-text {
  background: linear-gradient(90deg, var(--color-accent-cyan), var(--color-accent-magenta));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.highlight-cyan {
  color: var(--color-accent-cyan);
  font-weight: var(--font-weight-semibold);
}

.highlight-magenta {
  color: var(--color-accent-magenta);
  font-weight: var(--font-weight-semibold);
}

/* Accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--color-accent-cyan);
  color: var(--color-background-primary);
  padding: var(--space-2) var(--space-4);
  text-decoration: none;
  z-index: 100;
}

.skip-link:focus {
  top: 0;
}

/* Navigation */
.nav-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 64px;
  background: var(--glass-standard-background);
  backdrop-filter: blur(var(--glass-standard-blur));
  border-bottom: var(--glass-standard-border);
  z-index: 1000;
  display: flex;
  align-items: center;
}

.nav-container {
  width: 100%;
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 var(--space-6);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.nav-title {
  font-size: var(--font-size-h3);
  font-weight: var(--font-weight-bold);
  margin: 0;
}

.nav-links {
  display: flex;
  list-style: none;
  gap: var(--space-5);
}

.nav-links a {
  color: var(--color-text-secondary);
  text-decoration: none;
  transition: color var(--duration-micro) var(--easing-standard);
}

.nav-links a:hover,
.nav-links a[aria-current="true"] {
  color: var(--color-accent-cyan);
}

/* Progress Bar */
.progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--color-accent-cyan), var(--color-accent-magenta));
  width: 0%;
  z-index: 9999;
  transition: width 100ms ease-out;
}

/* Sections - Transparent to show body::before scene backgrounds */
.section {
  min-height: 100vh;
  position: relative;
  padding: var(--space-8) 0;
  background: transparent; /* Let scene backgrounds show through */
  z-index: 1; /* Above body::before background layer */
}

/* Increase distance between hero and ignite */
#section-ignite {
  padding-top: calc(var(--space-8) * 2);
}

/* Ensure fade section is tall enough to show forest SVG below viz */
#section-fade {
  min-height: 140vh;
  padding-bottom: var(--space-12);
}

/* Reduce formula section to close gap with fade */
#section-takeaway {
  padding-top: var(--space-2);
  margin-top: calc(-1 * var(--space-8));
}

/* Ensure ingredients section is tall enough to trigger lab scene */
#section-ingredients {
  min-height: 135vh;
  padding-bottom: 0 !important; /* NO gap before footer */
  margin-bottom: 0 !important;
  padding-top: var(--space-6);
}

.section-container {
  max-width: 100%;
  margin: 0 auto;
  padding: 0 var(--space-6);
  width: 100%;
  height: 100%;
}

.section-annotations {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  z-index: 10;
}

/* Semantic Backgrounds - Scene-based */
:root {
  --accent-cyan: #00FFE0;
  --accent-magenta: #FF00E0;
  --gold: #FFEB3B;
}

/* Scene Background System - Smooth, Creative Transitions */

/* Fixed scene background layer - smooth cross-fade between scenes */
body::before {
  content: '';
  display: block !important; /* Force display - override any inherited display:none */
  position: fixed;
  inset: 0;
  z-index: 0; /* Changed from -1 to work with section stacking context */
  transition: opacity 500ms cubic-bezier(0.4, 0.0, 0.2, 1),
              background 500ms cubic-bezier(0.4, 0.0, 0.2, 1);
  opacity: 1;
  will-change: background;
  pointer-events: none; /* Allow clicks to pass through */
}

/* Cosmos - Deep space with visible purple */
body[data-scene="cosmos"]::before {
  background: radial-gradient(ellipse 1400px 900px at 50% 30%,
    rgba(40, 40, 80, 0.65) 0%,
    rgba(30, 30, 60, 0.50) 40%,
    rgba(20, 20, 40, 0.35) 70%,
    transparent 100%);
}

/* Dawn - Sunrise with visible horizon glow and sky gradient
   Metaphor: The spark moment when trends ignite */
body[data-scene="dawn"]::before {
  background:
    /* Bright sun on horizon - concentrated glow */
    radial-gradient(ellipse 800px 300px at 50% 85%, rgba(255, 180, 80, 0.70) 0%, rgba(255, 140, 60, 0.45) 30%, rgba(255, 100, 80, 0.25) 60%, transparent 100%),
    /* Warm orange sky spreading from horizon */
    radial-gradient(ellipse 1600px 700px at 50% 80%, rgba(255, 120, 60, 0.50) 0%, rgba(240, 100, 80, 0.35) 40%, transparent 75%),
    /* Purple-pink upper atmosphere */
    radial-gradient(ellipse 2000px 900px at 50% 20%, rgba(180, 80, 140, 0.42) 0%, rgba(140, 60, 120, 0.28) 50%, transparent 85%),
    /* Deep purple night sky at top */
    linear-gradient(180deg,
      rgba(60, 30, 80, 0.55) 0%,
      rgba(80, 40, 100, 0.45) 20%,
      rgba(120, 60, 100, 0.35) 50%,
      transparent 100%);
}

/* Orbit (Surge) - Planet system with gravitational center and orbital rings
   Metaphor: Artists as planets pulling content into their orbit */
body[data-scene="orbit"]::before {
  background:
    /* Central "sun" - the gravitational center of viral trends */
    radial-gradient(circle 120px at 50% 50%, rgba(255, 200, 100, 0.35) 0%, rgba(255, 150, 80, 0.20) 40%, transparent 100%),
    /* Inner orbital glow */
    radial-gradient(circle 300px at 50% 50%, rgba(255, 100, 150, 0.18) 60%, transparent 100%),
    /* Outer space nebula */
    radial-gradient(ellipse 1400px 900px at 50% 50%, rgba(100, 150, 255, 0.25) 0%, rgba(80, 120, 200, 0.15) 40%, transparent 80%),
    /* Deep space purple */
    radial-gradient(ellipse 1600px 1000px at 50% 50%, rgba(50, 50, 120, 0.40) 0%, rgba(30, 30, 80, 0.28) 60%, transparent 100%);
}

/* City - Night sky atmosphere (SVG handles buildings)
   Metaphor: Communities form like city districts with distinct cultures */
body[data-scene="city"]::before {
  background:
    /* Distant city glow on horizon - moderate */
    radial-gradient(ellipse 1100px 320px at 50% 75%, rgba(255, 140, 60, 0.22) 0%, rgba(255, 120, 65, 0.14) 40%, rgba(255, 100, 50, 0.08) 70%, transparent 90%),
    /* Many more stars scattered across sky */
    radial-gradient(circle 3px at 8% 12%, rgba(255, 255, 255, 0.95) 0%, transparent 100%),
    radial-gradient(circle 2px at 15% 22%, rgba(255, 255, 255, 0.8) 0%, transparent 100%),
    radial-gradient(circle 3px at 22% 8%, rgba(255, 255, 255, 1.0) 0%, transparent 100%),
    radial-gradient(circle 2px at 28% 32%, rgba(255, 255, 255, 0.75) 0%, transparent 100%),
    radial-gradient(circle 3px at 35% 15%, rgba(255, 255, 255, 0.9) 0%, transparent 100%),
    radial-gradient(circle 2px at 42% 28%, rgba(255, 255, 255, 0.85) 0%, transparent 100%),
    radial-gradient(circle 3px at 48% 18%, rgba(255, 255, 255, 0.95) 0%, transparent 100%),
    radial-gradient(circle 2px at 55% 38%, rgba(255, 255, 255, 0.7) 0%, transparent 100%),
    radial-gradient(circle 3px at 62% 12%, rgba(255, 255, 255, 1.0) 0%, transparent 100%),
    radial-gradient(circle 2px at 68% 35%, rgba(255, 255, 255, 0.8) 0%, transparent 100%),
    radial-gradient(circle 3px at 75% 22%, rgba(255, 255, 255, 0.9) 0%, transparent 100%),
    radial-gradient(circle 2px at 82% 48%, rgba(255, 255, 255, 0.75) 0%, transparent 100%),
    radial-gradient(circle 2px at 88% 28%, rgba(255, 255, 255, 0.85) 0%, transparent 100%),
    radial-gradient(circle 3px at 95% 18%, rgba(255, 255, 255, 0.95) 0%, transparent 100%),
    radial-gradient(circle 2px at 12% 48%, rgba(255, 255, 255, 0.7) 0%, transparent 100%),
    radial-gradient(circle 2px at 18% 58%, rgba(255, 255, 255, 0.8) 0%, transparent 100%),
    radial-gradient(circle 3px at 38% 52%, rgba(255, 255, 255, 0.85) 0%, transparent 100%),
    radial-gradient(circle 2px at 52% 58%, rgba(255, 255, 255, 0.75) 0%, transparent 100%),
    radial-gradient(circle 3px at 65% 55%, rgba(255, 255, 255, 0.9) 0%, transparent 100%),
    radial-gradient(circle 2px at 78% 62%, rgba(255, 255, 255, 0.8) 0%, transparent 100%),
    radial-gradient(circle 2px at 92% 58%, rgba(255, 255, 255, 0.85) 0%, transparent 100%),
    /* Night sky gradient */
    linear-gradient(180deg,
      rgba(4, 12, 24, 0.85) 0%,
      rgba(8, 24, 42, 0.75) 30%,
      rgba(12, 32, 52, 0.70) 60%,
      rgba(16, 40, 60, 0.65) 100%);
}

/* Forest - Atmospheric base (SVG handles trees)
   Metaphor: Trends fade like leaves, but forests regrow */
body[data-scene="forest"]::before {
  background:
    /* Strong sun rays through trees - more prominent */
    radial-gradient(ellipse 900px 700px at 30% 70%, rgba(255, 235, 160, 0.35) 0%, rgba(255, 225, 140, 0.18) 40%, transparent 70%),
    radial-gradient(ellipse 600px 500px at 50% 68%, rgba(255, 240, 180, 0.22) 0%, rgba(255, 230, 160, 0.10) 45%, transparent 65%),
    /* More dappled light patches throughout forest */
    radial-gradient(circle 350px at 70% 75%, rgba(210, 255, 190, 0.22) 0%, transparent 65%),
    radial-gradient(circle 280px at 15% 80%, rgba(190, 245, 170, 0.18) 0%, transparent 55%),
    radial-gradient(circle 220px at 85% 78%, rgba(225, 255, 205, 0.14) 0%, transparent 50%),
    radial-gradient(circle 200px at 40% 72%, rgba(200, 250, 180, 0.12) 0%, transparent 55%),
    radial-gradient(circle 180px at 92% 85%, rgba(215, 255, 195, 0.10) 0%, transparent 50%),
    /* Atmospheric depth */
    linear-gradient(180deg,
      rgba(25, 60, 35, 0.90) 0%,
      rgba(18, 50, 28, 0.85) 20%,
      rgba(25, 65, 38, 0.75) 50%,
      rgba(32, 80, 48, 0.65) 100%);
}

/* Air (Emotion) - Vibrant multicolor emotional atmosphere */
body[data-scene="air"]::before {
  background:
    /* Flowing wave patterns for visual interest */
    radial-gradient(ellipse 1000px 200px at 0% 40%, rgba(255, 140, 180, 0.15) 0%, rgba(255, 120, 160, 0.08) 50%, transparent 70%),
    radial-gradient(ellipse 900px 180px at 100% 60%, rgba(160, 200, 255, 0.12) 0%, rgba(140, 180, 235, 0.06) 50%, transparent 65%),
    radial-gradient(ellipse 1100px 220px at 50% 80%, rgba(180, 255, 200, 0.10) 0%, rgba(160, 235, 180, 0.05) 50%, transparent 60%),
    /* Concentric rings for depth */
    radial-gradient(circle 600px at 30% 35%, transparent 30%, rgba(255, 160, 200, 0.08) 35%, transparent 40%),
    radial-gradient(circle 450px at 70% 50%, transparent 35%, rgba(180, 210, 255, 0.07) 40%, transparent 45%),
    /* Pink joy */
    radial-gradient(circle 700px at 20% 30%, rgba(255, 120, 170, 0.32) 0%, rgba(255, 100, 150, 0.18) 50%, transparent 65%),
    /* Blue calm */
    radial-gradient(circle 900px at 75% 60%, rgba(120, 170, 255, 0.28) 0%, rgba(100, 150, 230, 0.15) 50%, transparent 65%),
    /* Green energy */
    radial-gradient(circle 600px at 50% 80%, rgba(170, 255, 220, 0.25) 0%, rgba(150, 230, 200, 0.12) 50%, transparent 60%),
    /* Warm glow */
    radial-gradient(ellipse 1400px 500px at 50% 40%, rgba(255, 200, 120, 0.20) 0%, rgba(255, 180, 100, 0.10) 40%, transparent 70%),
    /* Base gradient */
    linear-gradient(135deg,
      rgba(40, 35, 50, 0.55) 0%,
      rgba(35, 40, 55, 0.42) 50%,
      rgba(30, 35, 45, 0.35) 100%);
}

/* Lab - Atmospheric base (SVG handles equipment)
   Metaphor: The formula - recipe ingredients analysis */
body[data-scene="lab"]::before {
  background:
    /* Subtle molecular orbital rings - elegant and scientific */
    radial-gradient(circle 500px at 75% 25%, transparent 35%, rgba(80, 180, 220, 0.04) 37%, transparent 39%),
    radial-gradient(circle 400px at 75% 25%, transparent 40%, rgba(100, 200, 240, 0.05) 42%, transparent 44%),
    radial-gradient(circle 300px at 75% 25%, transparent 45%, rgba(120, 220, 255, 0.06) 47%, transparent 49%),
    /* Soft glowing light from lab equipment */
    radial-gradient(circle 450px at 20% 45%, rgba(80, 200, 240, 0.15) 0%, rgba(60, 180, 220, 0.08) 50%, transparent 70%),
    radial-gradient(circle 350px at 85% 70%, rgba(100, 220, 200, 0.12) 0%, rgba(80, 200, 180, 0.06) 50%, transparent 65%),
    /* Overhead cool lab lighting */
    radial-gradient(ellipse 800px 400px at 50% 0%, rgba(200, 230, 250, 0.20) 0%, rgba(180, 210, 230, 0.10) 50%, transparent 80%),
    /* Clean scientific atmosphere */
    linear-gradient(180deg,
      rgba(15, 40, 55, 0.90) 0%,
      rgba(18, 50, 65, 0.85) 30%,
      rgba(20, 55, 70, 0.80) 60%,
      rgba(22, 60, 75, 0.75) 100%);
}

/* Scene layers - decorative overlays per scene */
.scene-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 500ms cubic-bezier(0.4, 0.0, 0.2, 1);
  will-change: opacity;
}

/* Stars - Animated twinkling field */
body[data-scene="cosmos"] .scene--stars {
  opacity: 0.4;
  background-image:
    radial-gradient(2px 2px at 15% 25%, rgba(255, 255, 255, 0.6) 0 2px, transparent 2px),
    radial-gradient(1px 1px at 55% 65%, rgba(0, 255, 224, 0.4) 0 1px, transparent 1px),
    radial-gradient(2px 2px at 35% 45%, rgba(255, 255, 255, 0.5) 0 2px, transparent 2px),
    radial-gradient(1px 1px at 75% 15%, rgba(255, 0, 224, 0.3) 0 1px, transparent 1px),
    radial-gradient(1px 1px at 90% 80%, rgba(255, 255, 255, 0.4) 0 1px, transparent 1px);
  background-size: 140px 140px, 180px 180px, 200px 200px, 220px 220px, 160px 160px;
  animation: starfield-drift 120s linear infinite;
}

@keyframes starfield-drift {
  0% { background-position: 0 0, 0 0, 0 0, 0 0, 0 0; }
  100% { background-position: 140px 140px, -180px 180px, 200px -200px, -220px -220px, 160px 160px; }
}

/* Orbits - Concentric rings representing planetary orbits
   Metaphor: Artists' gravitational pull creates orbit paths for content */
body[data-scene="orbit"] .scene--orbits {
  opacity: 0.38;
  background-image:
    /* Innermost orbit - fastest rotation */
    radial-gradient(circle 250px at 50% 50%, transparent 248px, rgba(100, 180, 255, 0.25) 249px, rgba(100, 180, 255, 0.15) 250px, transparent 251px),
    /* Second orbit */
    radial-gradient(circle 380px at 50% 50%, transparent 378px, rgba(150, 200, 255, 0.20) 379px, rgba(150, 200, 255, 0.12) 380px, transparent 381px),
    /* Third orbit */
    radial-gradient(circle 520px at 50% 50%, transparent 518px, rgba(180, 220, 255, 0.16) 519px, rgba(180, 220, 255, 0.09) 520px, transparent 521px),
    /* Outermost orbit - slowest */
    radial-gradient(circle 680px at 50% 50%, transparent 678px, rgba(200, 230, 255, 0.12) 679px, rgba(200, 230, 255, 0.06) 680px, transparent 681px),
    /* Small orbital bodies/satellites scattered */
    radial-gradient(circle 8px at 35% 40%, rgba(255, 200, 150, 0.4) 0%, transparent 100%),
    radial-gradient(circle 6px at 65% 55%, rgba(200, 150, 255, 0.35) 0%, transparent 100%),
    radial-gradient(circle 7px at 45% 65%, rgba(150, 255, 200, 0.3) 0%, transparent 100%),
    radial-gradient(circle 5px at 58% 38%, rgba(255, 180, 200, 0.35) 0%, transparent 100%);
  animation: orbital-pulse 8s ease-in-out infinite;
}

@keyframes orbital-pulse {
  0%, 100% { opacity: 0.38; }
  50% { opacity: 0.45; }
}

/* City Grid - Perspective-like converging lines */
body[data-scene="city"] .scene--grid {
  opacity: 0.3;
  background:
    linear-gradient(rgba(0, 255, 224, 0.12) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0, 200, 255, 0.08) 1px, transparent 1px),
    radial-gradient(ellipse at bottom, rgba(100, 200, 255, 0.06) 0%, transparent 50%);
  background-size: 40px 40px, 40px 40px, 100% 400px;
  background-position: 0 0, 0 0, center bottom;
}

/* Forest Canopy - Layered organic shapes with light filtering */
body[data-scene="forest"] .scene--canopy {
  opacity: 0.35;
  background:
    radial-gradient(ellipse 800px 250px at 30% 0%, rgba(100, 180, 100, 0.4) 0%, transparent 50%),
    radial-gradient(ellipse 600px 200px at 70% 0%, rgba(80, 160, 90, 0.35) 0%, transparent 50%),
    radial-gradient(ellipse 700px 220px at 50% 0%, rgba(90, 170, 95, 0.3) 0%, transparent 50%),
    linear-gradient(180deg, transparent 0%, rgba(60, 120, 70, 0.15) 30%, transparent 70%);
}

/* Emotion Orbs - Colorful floating spheres representing different emotions */
body[data-scene="air"] .scene--bubbles {
  opacity: 0.35;
  background-image:
    /* Joy - warm yellow/orange */
    radial-gradient(circle 80px at 25% 35%, rgba(255, 200, 100, 0.20) 20%, rgba(255, 150, 80, 0.08) 50%, transparent 80%),
    /* Calm - cool blue */
    radial-gradient(circle 100px at 70% 60%, rgba(100, 180, 255, 0.18) 20%, rgba(80, 150, 230, 0.06) 50%, transparent 80%),
    /* Energy - cyan/green */
    radial-gradient(circle 70px at 15% 75%, rgba(100, 255, 200, 0.16) 20%, rgba(80, 230, 180, 0.05) 50%, transparent 80%),
    /* Excitement - pink/magenta */
    radial-gradient(circle 90px at 80% 25%, rgba(255, 100, 180, 0.18) 20%, rgba(230, 80, 150, 0.06) 50%, transparent 80%),
    /* Subtle background orbs */
    radial-gradient(circle 60px at 50% 50%, rgba(200, 200, 255, 0.10) 30%, rgba(180, 180, 230, 0.03) 60%, transparent 90%),
    radial-gradient(circle 50px at 35% 20%, rgba(255, 220, 180, 0.08) 30%, transparent 70%);
  background-size: 350px 350px, 420px 420px, 300px 300px, 380px 380px, 250px 250px, 220px 220px;
  animation: emotion-drift 40s ease-in-out infinite;
}

@keyframes emotion-drift {
  0%, 100% {
    background-position: 0 0, 0 0, 0 0, 0 0, 0 0, 0 0;
  }
  33% {
    background-position: 30px 25px, -20px -30px, 35px -15px, -25px 20px, 15px 10px, -10px 8px;
  }
  66% {
    background-position: -25px 35px, 25px -20px, -30px 25px, 30px -25px, -12px 15px, 12px -10px;
  }
}

@media (prefers-reduced-motion: reduce) {
  .scene-layer {
    animation: none !important;
  }
  body[data-scene="cosmos"] .scene--stars {
    animation: none;
  }
  body[data-scene="air"] .scene--bubbles {
    animation: none;
  }
  body::before {
    transition: opacity 200ms ease, background 200ms ease;
  }
}

/* Legacy background classes - DISABLED (now using body scene system) */
/* These classes kept for HTML compatibility but no longer render backgrounds */
/* Removed background: transparent to avoid overriding .section base color */
.bg-cosmos,
.bg-dawn,
.bg-city,
.bg-canopy,
.bg-space,
.bg-lab,
.bg-forest,
.bg-neutral,
.bg-cosmos-deep {
  /* Empty - rely on body[data-scene] system for backgrounds */
  position: relative;
}

/* Remove all ::before and ::after from legacy classes */
.bg-cosmos::before,
.bg-city::after,
.bg-canopy::before,
.bg-space::after,
.bg-lab::before {
  display: none;
}

/* Hero Section */
.hero-section {
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(ellipse at center,
    var(--color-background-secondary) 0%,
    var(--color-background-primary) 100%);
}

.starfield {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
  opacity: 1 !important; /* Force visible - prevent any JS from hiding */
  z-index: 0;
}

.star {
  position: absolute;
  background: white;
  border-radius: 50%;
  opacity: 0.9;
  animation: twinkle 5s infinite;
  box-shadow: 0 0 2px rgba(255, 255, 255, 0.5);
}

@keyframes twinkle {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

.hero-content {
  text-align: center;
  z-index: 1;
}

.hero-subtitle {
  font-size: var(--font-size-body-lg);
  color: var(--color-text-secondary);
  margin-top: var(--space-4);
}

.scroll-cue {
  margin-top: var(--space-7);
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(10px); }
}

/* Distinct Layout Patterns */
.layout-split-left {
  display: grid;
  grid-template-columns: 1fr 2fr;
  gap: var(--space-7);
  align-items: center;
}

.layout-split-right {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: var(--space-7);
  align-items: center;
}

.layout-center-stage {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  width: 100%;
  max-width: 100%;
  margin: 0 auto;
}

.layout-network-audio {
  display: grid;
  grid-template-columns: 200px 1fr 300px;
  gap: var(--space-6);
  align-items: start;
}

.layout-canopy {
  position: relative;
  min-height: 100vh;
}

.layout-emotion-panel {
  display: grid;
  grid-template-columns: 250px 1fr;
  gap: var(--space-7);
}

.layout-ingredient-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--space-5);
  padding: var(--space-6);
}

/* Legacy layout names for compatibility */
.layout-left-viz {
  display: grid;
  grid-template-columns: 60% 40%;
  gap: var(--space-7);
  min-height: 80vh;
}

.layout-fullbleed {
  position: relative;
}

.layout-center-network {
  display: grid;
  grid-template-columns: 1fr 250px;
  gap: var(--space-7);
}

.layout-bubble-cloud {
  display: grid;
  grid-template-columns: 200px 1fr 300px;
  gap: var(--space-5);
}

/* Sticky Rail */
.sticky-rail {
  position: sticky;
  top: 120px;
  height: fit-content;
}

/* TASK 2 - Enhanced layout utilities for distinct section compositions */
.layout-left-rail {
  display: grid;
  grid-template-columns: minmax(480px, 2fr) minmax(280px, 1fr);
  gap: 24px;
  align-items: start;
}

.layout-full-bleed {
  position: relative;
  width: 100%;
}

.bottom-rail {
  position: sticky;
  bottom: 0;
  padding: 8px 16px;
  background: rgba(0, 0, 0, 0.25);
  backdrop-filter: blur(8px);
  border-top: 1px solid rgba(255, 255, 255, 0.07);
  z-index: 10;
}

.layout-audio-tray {
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 24px;
  align-items: start;
}

.audio-tray {
  display: grid;
  gap: 12px;
  position: sticky;
  top: 120px;
  max-height: calc(100vh - 160px);
  overflow-y: auto;
}

.layout-kpi-rail {
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 24px;
  align-items: start;
}

.kpi-rail {
  display: grid;
  gap: 8px;
  position: sticky;
  top: 120px;
  max-height: calc(100vh - 160px);
}

.layout-legend-drawer {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 24px;
  position: relative;
}

.drawer {
  position: absolute;
  right: 16px;
  top: 16px;
  width: 320px;
  max-width: 80vw;
  background: var(--glass-frosted-background);
  backdrop-filter: blur(var(--glass-frosted-blur));
  border: var(--glass-frosted-border);
  border-radius: 8px;
  padding: var(--space-4);
  z-index: 100;
}

.layout-grid-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 16px;
}

/* Viz Containers */
.viz-container {
  width: 100%;
  min-height: 80vh;
  height: calc(100vh - 160px);
  border: 1px solid var(--color-border-interactive);
  border-radius: 8px;
  background: var(--color-background-secondary);
  padding: var(--space-6);
  position: relative;
  overflow: hidden;
  transition: all var(--duration-macro) var(--easing-standard);
  display: flex;
  align-items: center;
  justify-content: center;
}

.viz-fullwidth {
  width: 100%;
  max-width: 100%;
  border: none;
  padding: 0;
}

.viz-fullbleed {
  border: none;
  border-radius: 0;
  padding: 0;
}

.viz-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg,
    transparent,
    var(--color-accent-cyan),
    transparent);
  transform: translateX(-100%);
  animation: scan 3s infinite;
}

@keyframes scan {
  to { transform: translateX(100%); }
}

/* Scroll Steps */
.scroll-step {
  min-height: 50vh;
  padding: var(--space-6) 0;
}

/* KPI Rails */
.kpi-rail {
  display: flex;
  gap: var(--space-5);
  margin-top: var(--space-6);
  padding: var(--space-4);
  background: var(--glass-subtle-background);
  border-radius: 8px;
  border: var(--glass-subtle-border);
  backdrop-filter: blur(var(--glass-subtle-blur));
}

.kpi-rail-vertical {
  position: absolute;
  right: var(--space-6);
  top: 50%;
  transform: translateY(-50%);
}

.kpi-item {
  flex: 1;
}

.kpi-value {
  font-size: 2rem;
  font-weight: var(--font-weight-bold);
  color: var(--color-accent-cyan);
  font-family: var(--font-family-mono);
}

.kpi-label {
  font-size: var(--font-size-label);
  color: var(--color-text-disabled);
  margin-top: var(--space-1);
}

/* Year Selector */
.year-selector {
  display: inline-flex;
  gap: var(--space-1);
  padding: var(--space-1);
  background: var(--glass-subtle-background);
  border-radius: 8px;
  border: var(--glass-subtle-border);
}

.year-btn {
  padding: var(--space-2) var(--space-4);
  background: transparent;
  border: none;
  color: var(--color-text-secondary);
  cursor: pointer;
  transition: all var(--duration-micro) var(--easing-standard);
  border-radius: 6px;
  font-family: var(--font-family-sans);
}

.year-btn:hover {
  color: var(--color-accent-cyan);
}

.year-btn.active {
  background: var(--color-accent-cyan);
  color: var(--color-background-primary);
}

/* Annotation Rail */
.annotation-rail {
  position: absolute;
  bottom: var(--space-6);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
  z-index: 10;
}

.annotation {
  color: var(--color-text-secondary);
  margin-top: var(--space-3);
}

/* Audio Tray */
.audio-tray {
  position: sticky;
  top: 120px;
  height: fit-content;
  background: var(--glass-subtle-background);
  border-radius: 8px;
  border: var(--glass-subtle-border);
  padding: var(--space-4);
  backdrop-filter: blur(var(--glass-subtle-blur));
}

.audio-tray h3 {
  font-size: var(--font-size-label);
  margin-bottom: var(--space-3);
}

/* Legend Panel */
.legend-panel {
  background: var(--glass-subtle-background);
  border-radius: 8px;
  border: var(--glass-subtle-border);
  padding: var(--space-4);
  backdrop-filter: blur(var(--glass-subtle-blur));
}

.legend-panel h3 {
  font-size: var(--font-size-label);
  margin-bottom: var(--space-3);
}

.emotion-legend {
  list-style: none;
  padding: 0;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-2) var(--space-3);
}

/* Detail Drawer */
.detail-drawer {
  position: fixed;
  right: 0;
  top: 64px;
  bottom: 0;
  width: 400px;
  background: var(--glass-frosted-background);
  backdrop-filter: blur(var(--glass-frosted-blur));
  border-left: var(--glass-frosted-border);
  transform: translateX(100%);
  transition: transform var(--duration-macro) var(--easing-standard);
  z-index: 900;
  padding: var(--space-6);
}

.detail-drawer:not([aria-hidden="true"]) {
  transform: translateX(0);
}

.drawer-close {
  position: absolute;
  top: var(--space-4);
  right: var(--space-4);
  width: 32px;
  height: 32px;
  background: transparent;
  border: none;
  color: var(--color-text-secondary);
  font-size: 1.5rem;
  cursor: pointer;
  transition: color var(--duration-micro) var(--easing-standard);
}

.drawer-close:hover {
  color: var(--color-text-primary);
}

/* Quiz Modal */
.quiz-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--duration-macro) var(--easing-standard);
  z-index: 2000;
}

.quiz-modal:not([aria-hidden="true"]) {
  opacity: 1;
  pointer-events: auto;
}

.modal-content {
  background: var(--glass-frosted-background);
  backdrop-filter: blur(var(--glass-frosted-blur));
  border: var(--glass-frosted-border);
  border-radius: 12px;
  padding: var(--space-6);
  max-width: 600px;
  width: 90%;
}

.modal-close {
  margin-top: var(--space-4);
  padding: var(--space-3) var(--space-5);
  background: var(--color-accent-cyan);
  color: var(--color-background-primary);
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: var(--font-weight-semibold);
  transition: transform var(--duration-micro) var(--easing-standard);
}

.modal-close:hover {
  transform: scale(1.05);
}

/* Card Grid */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-5);
  margin-top: var(--space-6);
}

/* Footer - merged with lab bench appearance */
.site-footer {
  text-align: center;
  padding: var(--space-5) 0;
  padding-bottom: var(--space-5);
  border-top: none; /* No border - seamless merge with lab bench */
  margin-top: -5px !important; /* Eliminate gap completely */
  color: var(--color-text-secondary);
  /* Match lab bench color and fade to black */
  position: relative;
  z-index: 2;
  background: linear-gradient(180deg,
    #0b1116 0%,                     /* Exact lab bench color match */
    #0b1116 5%,                     /* Hold bench color briefly */
    rgba(8, 12, 15, 1) 20%,
    rgba(5, 8, 10, 1) 40%,
    #000000 65%,
    #000000 100%
  );
}

.site-footer a {
  color: var(--color-accent-cyan);
  text-decoration: none;
  transition: color var(--duration-micro) var(--easing-standard);
}

.site-footer a:hover {
  color: var(--color-accent-magenta);
}

/* Falling Leaves Animation */
.falling-leaves-container {
  position: fixed;
  top: 0;
  right: 0;
  width: 200px;
  height: 100%;
  pointer-events: none;
  z-index: 10;
}

.falling-leaf {
  position: absolute;
  width: 40px;
  height: 40px;
  cursor: pointer;
  pointer-events: auto;
  animation: fall var(--duration-cinematic) linear infinite;
  opacity: 0;
  transition: transform var(--duration-micro);
}

.falling-leaf svg {
  width: 100%;
  height: 100%;
  color: var(--color-accent-magenta);
}

.falling-leaf.interactive {
  pointer-events: auto;
}

.falling-leaf:hover {
  transform: scale(1.2);
}

@keyframes fall {
  0% {
    transform: translateY(-100px) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 0.7;
  }
  90% {
    opacity: 0.7;
  }
  100% {
    transform: translateY(calc(100vh + 100px)) rotate(360deg);
    opacity: 0;
  }
}

@keyframes float {
  from { transform: translateY(0); }
  to { transform: translateY(-20px); }
}

@keyframes pulse {
  0%, 100% { opacity: 0.05; }
  50% { opacity: 0.1; }
}

/* Ingredient Cards */
.ingredient-card {
  background: var(--glass-subtle-background);
  border-radius: 12px;
  padding: var(--space-5);
  border: var(--glass-subtle-border);
  backdrop-filter: blur(var(--glass-subtle-blur));
  cursor: pointer;
  transition: all var(--duration-micro) var(--easing-standard);
  position: relative;
  overflow: hidden;
}

.ingredient-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, transparent, var(--color-accent-cyan), transparent);
  transform: translateX(-100%);
  transition: transform var(--duration-macro);
  opacity: 0.1;
}

.ingredient-card:hover::before {
  transform: translateX(100%);
}

.ingredient-card:hover {
  transform: translateY(-4px);
  border-color: var(--color-accent-cyan);
  box-shadow: 0 10px 30px rgba(0, 255, 224, 0.2);
}

.ingredient-icon {
  width: 48px;
  height: 48px;
  margin-bottom: var(--space-3);
  color: var(--color-accent-cyan);
}

.ingredient-name {
  font-size: var(--font-size-h3);
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--space-2);
  color: var(--color-text-primary);
}

.ingredient-metrics {
  display: flex;
  gap: var(--space-4);
  margin-top: var(--space-3);
}

.metric-item {
  flex: 1;
}

.metric-value {
  font-size: var(--font-size-h2);
  font-weight: var(--font-weight-bold);
  font-family: var(--font-family-mono);
  color: var(--color-accent-magenta);
}

.metric-label {
  font-size: var(--font-size-caption);
  color: var(--color-text-disabled);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Enhanced Quiz Modal */
.quiz-comparison {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-6);
  margin-top: var(--space-6);
}

.comparison-side {
  text-align: center;
  padding: var(--space-5);
  background: var(--glass-subtle-background);
  border-radius: 12px;
  border: 2px solid transparent;
  transition: all var(--duration-micro);
}

.comparison-side.with {
  border-color: var(--color-accent-cyan);
}

.comparison-side.without {
  border-color: var(--color-accent-magenta);
}

.comparison-side h3 {
  font-size: var(--font-size-h2);
  margin-bottom: var(--space-4);
}

.comparison-stats {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.stat-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-2) 0;
  border-bottom: 1px solid var(--color-border-disabled);
}

.stat-row:last-child {
  border-bottom: none;
}

.stat-label {
  font-size: var(--font-size-body-sm);
  color: var(--color-text-secondary);
}

.stat-value {
  font-size: var(--font-size-h3);
  font-weight: var(--font-weight-bold);
  font-family: var(--font-family-mono);
}

/* Tooltips */
.viz-tooltip,
.planet-tooltip,
.emotion-tooltip,
.ingredient-tooltip {
  position: absolute;
  background: var(--glass-frosted-background);
  backdrop-filter: blur(var(--glass-frosted-blur));
  border: var(--glass-frosted-border);
  padding: var(--space-3);
  border-radius: 8px;
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--duration-micro) var(--easing-standard);
  color: var(--color-text-primary);
  font-size: var(--font-size-caption);
  z-index: 9999;
  max-width: 250px;
  box-shadow: var(--shadow-200);
}

/* Micro-interactions */
/* A) Planets - Comet effect */
.comet {
  position: absolute;
  top: 10%;
  right: -20%;
  width: 160px;
  height: 2px;
  background: linear-gradient(90deg, rgba(255, 255, 255, 0.0), rgba(255, 255, 255, 0.9));
  opacity: 0.9;
  transform: translate(0, 0) rotate(-20deg);
  transition: transform 0.4s linear, opacity 0.4s linear;
  pointer-events: none;
}

@media (prefers-reduced-motion: reduce) {
  .comet {
    display: none;
  }
}

/* B) Community - Audio tray effects */
.audio-item {
  cursor: pointer;
  padding: var(--space-2);
  border-radius: 4px;
  transition: background 200ms ease-out;
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.audio-item:hover {
  background: rgba(0, 255, 224, 0.1);
}

.audio-item.playing {
  background: rgba(0, 255, 224, 0.15);
  animation: audio-pulse 2s ease-in-out;
}

@keyframes audio-pulse {
  0%, 100% { background: rgba(0, 255, 224, 0.15); }
  50% { background: rgba(0, 255, 224, 0.25); }
}

/* Network edge emphasis when sound is active */
#viz-community.sound-active circle,
#viz-community.sound-active line {
  stroke-width: 2.5;
  transition: stroke-width 200ms ease-out;
}

/* C) Ranking - Leaf hint styles handled inline in JS */

/* D) Emotion - Bubble breathe (handled via JS transform) */
.bubble,
circle[data-type="bubble"] {
  transition: transform 150ms ease-out, stroke 150ms ease-out;
  transform-origin: center;
}

/* Responsive */
@media (max-width: 768px) {
  .nav-links {
    display: none;
  }

  .layout-left-viz,
  .layout-center-network,
  .layout-bubble-cloud {
    grid-template-columns: 1fr;
  }

  .detail-drawer {
    width: 100%;
  }

  .sticky-rail {
    position: static;
  }

  .kpi-rail-vertical {
    position: static;
    transform: none;
    margin-top: var(--space-4);
  }
}

/* Planet Visualization Specific Styles */
.legend {
  position: absolute;
  left: 100px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 15px;
  max-width: 250px;
  z-index: 10;
  pointer-events: none;
}

.legend-item {
  background: rgba(10, 10, 15, 0.9);
  padding: 14px 18px;
  border-radius: 8px;
  font-size: 0.85rem;
  backdrop-filter: blur(10px);
  border: 1px solid var(--color-border-interactive);
  color: var(--color-text-primary);
  pointer-events: auto;
  line-height: 1.5;
}

.legend-item strong {
  display: block;
  color: var(--color-accent-cyan);
  margin-bottom: 4px;
  font-size: 0.9rem;
}

.color-legend {
  position: absolute;
  left: 60px;
  bottom: 400px;
  width: min(450px, calc(100% - 120px));
  max-width: 450px;
  background: rgba(10, 10, 15, 0.9);
  padding: 18px;
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid var(--color-border-interactive);
  z-index: 10;
  pointer-events: none;
}

.color-legend-title {
  margin-bottom: 12px;
  font-size: 0.9rem;
  color: var(--color-text-primary);
}

.color-legend-title strong {
  display: block;
  color: var(--color-accent-magenta);
  margin-bottom: 8px;
}

.color-gradient-container {
  width: 100%;
}

.color-gradient-bar {
  width: 100%;
  height: 35px;
  border-radius: 6px;
  background: linear-gradient(
    to right,
    #FF0000 0%,      /* Red - 0.0 */
    #FF7F00 15%,     /* Orange - 0.15 */
    #FFFF00 30%,     /* Yellow - 0.3 */
    #00FF00 45%,     /* Green - 0.45 */
    #00FFFF 60%,     /* Cyan - 0.6 */
    #0000FF 75%,     /* Blue - 0.75 */
    #8B00FF 90%,     /* Purple - 0.9 */
    #FF00FF 100%     /* Magenta - 1.0 */
  );
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
  border: 2px solid rgba(255, 255, 255, 0.2);
}

.color-gradient-labels {
  display: flex;
  justify-content: space-between;
  margin-top: 8px;
  font-size: 0.75rem;
  padding: 0 2px;
}

.color-gradient-labels span {
  text-align: center;
  color: var(--color-text-primary);
  flex: 1;
}

.color-gradient-labels small {
  display: block;
  font-size: 0.7rem;
  color: var(--color-text-secondary);
  font-style: italic;
  margin-top: 2px;
}

/* Make sure the section container is positioned relative for absolute positioning */
#section-surge .section-container {
  position: relative;
}

/* Responsive: adjust for medium screens */
@media (max-width: 1400px) {
  .legend {
    left: 100px;
    max-width: 200px;
  }

  .legend-item {
    font-size: 0.8rem;
    padding: 12px 16px;
  }

  .color-legend {
    left: 40px;
    bottom: 60px;
    width: min(400px, calc(100% - 80px));
    padding: 16px;
  }
}

/* Responsive: stack legends on tablets */
@media (max-width: 1024px) {
  .legend {
    left: 10px;
    right: auto;
    top: 80px;
    transform: none;
    max-width: calc(50% - 20px);
    flex-direction: column;
  }

  .legend-item {
    font-size: 0.75rem;
    padding: 10px 14px;
  }

  .color-legend {
    left: 10px;
    right: auto;
    bottom: 10px;
    width: min(400px, calc(100% - 20px));
  }

  .color-legend-title {
    font-size: 0.8rem;
  }
}

/* Responsive: compact layout for mobile */
@media (max-width: 768px) {
  .legend {
    left: 10px;
    right: 10px;
    top: 70px;
    max-width: calc(100% - 20px);
    flex-direction: row;
    flex-wrap: wrap;
    gap: 8px;
  }

  .legend-item {
    font-size: 0.7rem;
    padding: 8px 12px;
    flex: 1 1 auto;
    min-width: 120px;
  }

  .legend-item strong {
    font-size: 0.75rem;
  }

  .color-legend {
    position: relative;
    left: auto;
    right: auto;
    bottom: auto;
    width: 100%;
    margin: 10px;
    padding: 12px;
  }

  .color-legend-title {
    font-size: 0.75rem;
    margin-bottom: 8px;
  }

  .color-gradient-bar {
    height: 28px;
  }

  .color-gradient-labels {
    font-size: 0.7rem;
  }

  .color-gradient-labels small {
    font-size: 0.65rem;
  }
}

.tooltip-planet {
  position: absolute;
  background: rgba(0, 0, 0, 0.95);
  color: white;
  padding: 12px 16px;
  border-radius: 8px;
  pointer-events: none;
  font-size: 0.9rem;
  z-index: 1000;
  max-width: 280px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
  border: 1px solid var(--color-accent-cyan);
  backdrop-filter: blur(10px);
}

.tooltip-planet strong {
  display: block;
  margin-bottom: 8px;
  font-size: 1.1rem;
  color: var(--color-accent-cyan);
  font-weight: var(--font-weight-bold);
}

.tooltip-planet div {
  margin: 4px 0;
  font-size: 0.85rem;
}

.planet {
  cursor: pointer;
  transition: all 0.3s ease;
  pointer-events: all;
}

.planet:hover {
  filter: brightness(1.3);
}

.planet-orbit {
  fill: none;
  stroke: var(--color-border-primary);
  stroke-width: 1;
  stroke-dasharray: 5, 5;
  opacity: 0.3;
}

.sun {
  filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
}

/* Year selector buttons in annotation rail */
.year-selector {
  display: flex;
  gap: 8px;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.year-btn {
  font-weight: var(--font-weight-semibold);
  padding: 8px 20px;
  background: var(--color-background-secondary);
  color: var(--color-text-primary);
  border: 1px solid var(--color-border-interactive);
  border-radius: 6px;
  cursor: pointer;
  transition: all var(--duration-micro) var(--easing-standard);
  font-size: var(--font-size-caption);
}

.year-btn:hover {
  background: var(--color-background-elevated);
  border-color: var(--color-accent-cyan);
  transform: translateY(-1px);
}

.year-btn.active {
  background: linear-gradient(135deg, var(--color-accent-cyan), var(--color-accent-magenta));
  color: var(--color-background-primary);
  border-color: transparent;
  box-shadow: 0 4px 12px rgba(0, 255, 224, 0.3);
}

/* Ingredients Grid */
.ingredients-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--space-4);
  padding: var(--space-4);
  width: 100%;
}

.ingredient-card {
  background: var(--color-background-secondary);
  border: 1px solid var(--color-border-interactive);
  border-radius: 12px;
  padding: var(--space-4);
  cursor: pointer;
  transition: all var(--duration-micro) var(--easing-standard);
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.ingredient-card:hover,
.ingredient-card:focus {
  background: var(--color-background-elevated);
  border-color: var(--color-accent-cyan);
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(0, 255, 224, 0.2);
  outline: none;
}

.ingredient-card.highlighted {
  border-color: var(--color-accent-magenta);
  box-shadow: 0 0 20px rgba(255, 0, 224, 0.3);
}

.card-icon {
  font-size: 2.5rem;
  text-align: center;
  margin-bottom: var(--space-2);
}

.card-title {
  font-size: var(--font-size-h4);
  font-weight: var(--font-weight-bold);
  color: var(--color-text-primary);
  text-align: center;
  margin-bottom: var(--space-1);
}

.card-description {
  font-size: var(--font-size-caption);
  color: var(--color-text-secondary);
  text-align: center;
  flex-grow: 1;
}

.card-action {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-1);
  padding: var(--space-2) var(--space-3);
  background: var(--color-background-primary);
  border: 1px solid var(--color-border-interactive);
  border-radius: 6px;
  color: var(--color-accent-cyan);
  cursor: pointer;
  transition: all var(--duration-micro) var(--easing-standard);
  font-size: var(--font-size-caption);
  font-weight: var(--font-weight-semibold);
}

.card-action:hover {
  background: var(--color-accent-cyan);
  color: var(--color-background-primary);
  border-color: var(--color-accent-cyan);
}

/* Quiz Modal */
.quiz-modal {
  position: fixed;
  inset: 0;
  background: rgba(10, 10, 15, 0.95);
  backdrop-filter: blur(10px);
  z-index: 9999;
  display: none;
  align-items: center;
  justify-content: center;
  padding: var(--space-4);
}

.quiz-modal.active {
  display: flex;
}

.quiz-content {
  background: var(--color-background-secondary);
  border: 1px solid var(--color-border-interactive);
  border-radius: 16px;
  padding: var(--space-6);
  max-width: 900px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  position: relative;
}

.quiz-close {
  position: absolute;
  top: var(--space-3);
  right: var(--space-3);
  background: transparent;
  border: none;
  color: var(--color-text-secondary);
  font-size: 2rem;
  cursor: pointer;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all var(--duration-micro) var(--easing-standard);
}

.quiz-close:hover {
  background: var(--color-background-primary);
  color: var(--color-text-primary);
}

.quiz-ingredient-info {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-4);
}

.quiz-icon {
  font-size: 3rem;
}

.quiz-ingredient-name {
  font-size: var(--font-size-h3);
  color: var(--color-text-primary);
}

.quiz-comparison {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-4);
  margin: var(--space-4) 0;
}

.comparison-with,
.comparison-without {
  background: var(--color-background-primary);
  padding: var(--space-4);
  border-radius: 12px;
  border: 1px solid var(--color-border-primary);
}

.comparison-with.winner {
  border-color: var(--color-accent-cyan);
  box-shadow: 0 0 20px rgba(0, 255, 224, 0.3);
}

.metric-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-3);
}

.metric-label {
  min-width: 60px;
  font-size: var(--font-size-caption);
  color: var(--color-text-secondary);
}

.metric-bar {
  flex-grow: 1;
  height: 24px;
  background: var(--color-background-secondary);
  border-radius: 12px;
  position: relative;
  overflow: hidden;
}

.bar-fill {
  height: 100%;
  border-radius: 12px;
  transition: width var(--duration-macro) var(--easing-standard);
}

.with-fill {
  background: linear-gradient(90deg, var(--color-accent-cyan), var(--color-accent-magenta));
}

.without-fill {
  background: var(--color-border-interactive);
}

.metric-value {
  margin-left: var(--space-2);
  font-family: var(--font-family-mono);
  font-size: var(--font-size-caption);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-primary);
}

.quiz-examples {
  margin-top: var(--space-4);
  padding: var(--space-3);
  background: var(--color-background-primary);
  border-radius: 8px;
}

.example-list {
  list-style: none;
  padding: 0;
  margin: var(--space-2) 0 0 0;
}

.example-list li {
  padding: var(--space-2) 0;
  border-bottom: 1px solid var(--color-border-primary);
  color: var(--color-text-secondary);
}

.example-list li:last-child {
  border-bottom: none;
}

.quiz-actions {
  display: flex;
  gap: var(--space-3);
  justify-content: center;
  margin-top: var(--space-4);
}

.btn-primary,
.btn-secondary {
  padding: var(--space-2) var(--space-4);
  border-radius: 8px;
  font-weight: var(--font-weight-semibold);
  cursor: pointer;
  transition: all var(--duration-micro) var(--easing-standard);
  border: none;
}

.btn-primary {
  background: linear-gradient(135deg, var(--color-accent-cyan), var(--color-accent-magenta));
  color: var(--color-background-primary);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 255, 224, 0.4);
}

.btn-secondary {
  background: var(--color-background-primary);
  color: var(--color-text-primary);
  border: 1px solid var(--color-border-interactive);
}

.btn-secondary:hover {
  background: var(--color-background-elevated);
  border-color: var(--color-accent-cyan);
}

.quiz-prompt {
  background: linear-gradient(135deg, rgba(0, 255, 224, 0.1), rgba(255, 0, 224, 0.1));
  padding: var(--space-3);
  border-radius: 8px;
  text-align: center;
  margin-bottom: var(--space-4);
  border: 1px solid var(--color-accent-cyan);
  transition: opacity var(--duration-macro) var(--easing-standard);
}

@media (max-width: 768px) {
  .ingredients-grid {
    grid-template-columns: 1fr;
  }

  .quiz-comparison {
    grid-template-columns: 1fr;
  }

  .quiz-content {
    padding: var(--space-4);
  }
}

/* ════════════════════════════════════════════════════════════════════════
   Scene Illustrations (SVG overlays)
   ════════════════════════════════════════════════════════════════════════ */

/* Shared base */
.illu {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  height: 400px;
  pointer-events: none;
  opacity: 0;
  animation: illuFadeIn 800ms cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
  z-index: 1; /* Above body::before, same layer as scene decorations */
}

@keyframes illuFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ──────────────────────────────────────────────────────────────────────
   FOREST
   ────────────────────────────────────────────────────────────────────── */

.illu-forest .forest-ridge {
  /* Use gradient from SVG for 3D depth effect */
  opacity: 0.85; /* Increased from 0.6 for visibility */
  filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.15)); /* Subtle shadow */
}

.illu-forest .forest-ground {
  fill: #0b1f17;
  opacity: 0.9; /* Increased for more solidity */
}

.illu-forest .forest-bush {
  /* Use gradient from SVG for 3D depth */
  opacity: 0.85; /* Increased for definition */
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.15)); /* Subtle shadow */
}

.illu-forest .leaf {
  /* Use gradient from SVG for 3D lighting effect */
  stroke: rgba(20, 100, 70, 0.6); /* Stronger stroke for depth */
  stroke-width: 0.8;
}

.illu-forest .trunk {
  /* Use gradient from SVG for cylindrical 3D effect */
  stroke: #2a3632;
  stroke-width: 1.5; /* Thicker outline for definition */
}

.illu-forest .forest-cloud {
  fill: #d0e0d8;
  opacity: 0.45; /* Slightly more visible */
}

.illu-forest .forest-bird {
  fill: none;
  stroke: #1a3a2a;
  stroke-width: 1.5;
  stroke-linecap: round;
  opacity: 0.7; /* More visible */
  animation: birdFly 6s ease-in-out infinite;
}

@keyframes birdFly {
  0%, 100% {
    transform: translateX(0) translateY(0);
  }
  25% {
    transform: translateX(40px) translateY(-15px);
  }
  50% {
    transform: translateX(80px) translateY(-5px);
  }
  75% {
    transform: translateX(120px) translateY(-20px);
  }
}

.illu-forest .forest-mountains {
  /* Use gradient from SVG for 3D depth effect */
  opacity: 0.75; /* Increased from 0.4 for much better visibility */
  filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2)); /* Moderate shadow */
}

.pine.sway {
  transform-origin: 50% 100%;
  animation: sway 4.5s ease-in-out infinite alternate;
  filter: drop-shadow(1px 2px 3px rgba(0, 0, 0, 0.2)); /* Subtle shadow */
}

@keyframes sway {
  from { transform: rotate(-1.2deg); }
  to { transform: rotate(1.2deg); }
}

/* Easter egg: falling leaf */
@keyframes leafFall {
  from {
    transform: translateY(0) rotate(0deg);
    opacity: 0.8;
  }
  to {
    transform: translateY(40px) rotate(180deg);
    opacity: 0;
  }
}

@keyframes leafFadeOnly {
  0%, 50% { opacity: 0.8; }
  100% { opacity: 0; }
}

@media (prefers-reduced-motion: reduce) {
  .pine.sway {
    animation: none;
  }
}

/* ──────────────────────────────────────────────────────────────────────
   CITY
   ────────────────────────────────────────────────────────────────────── */

.illu-city .bldg {
  fill: #0e1722;
  opacity: 0.9;
}

.illu-city .win {
  fill: #f7f3c8;
  opacity: 0;
}

.illu-city .twinkle {
  animation: tw 2.4s ease-in-out infinite;
}

@keyframes tw {
  0%, 100% { opacity: 0; }
  50% { opacity: 0.9; }
}

.illu-city .city-ground {
  fill: #0a0d12;
}

/* Easter egg: beacon pulse */
@keyframes beaconPulse {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  50% {
    opacity: 0.8;
  }
  100% {
    opacity: 0;
    transform: scale(1.5);
  }
}

.illu-city .city-antenna {
  stroke: #3a4a52;
  stroke-width: 2;
  opacity: 0.8;
}

.illu-city .city-antenna-light {
  fill: #ff3030;
  opacity: 0.9;
  animation: antennaBlinkSlow 2s ease-in-out infinite;
}

@keyframes antennaBlinkSlow {
  0%, 100% { opacity: 0.9; }
  50% { opacity: 0.3; }
}

/* Diagonal shooting stars - MORE VISIBLE */
.illu-city .city-meteor {
  opacity: 0;
  animation: meteorStreak 4s ease-out infinite; /* Faster cycle */
}

@keyframes meteorStreak {
  0%, 75%, 100% {
    opacity: 0;
    transform: translate(0, 0);
  }
  3% {
    opacity: 1;
  }
  25% {
    opacity: 0;
    transform: translate(150px, 100px); /* Longer diagonal streak */
  }
}

/* Sparkling effect for meteor trail points */
.illu-city .meteor-trail-sparkle {
  animation: meteorTrailSparkle 0.8s ease-in-out infinite;
}

@keyframes meteorTrailSparkle {
  0%, 100% {
    opacity: 0.4;
    transform: scale(0.8);
  }
  50% {
    opacity: 1;
    transform: scale(1.6);
  }
}

/* Sparkling effect for meteor head */
.illu-city .meteor-head-sparkle {
  animation: meteorHeadSparkle 1s ease-in-out infinite;
}

@keyframes meteorHeadSparkle {
  0%, 100% {
    filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.8));
  }
  50% {
    filter: drop-shadow(0 0 12px rgba(255, 255, 255, 1));
  }
}

/* White pulse for meteor glow */
.illu-city .meteor-glow-sparkle {
  animation: meteorGlowSparkle 1.5s ease-in-out infinite;
}

@keyframes meteorGlowSparkle {
  0%, 100% {
    opacity: 0.4;
  }
  50% {
    opacity: 0.9;
    filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.9));
  }
}

@media (prefers-reduced-motion: reduce) {
  .illu-city .twinkle,
  .illu-city .city-neon,
  .illu-city .city-antenna-light,
  .illu-city .city-meteor,
  .illu-city .meteor-trail-sparkle,
  .illu-city .meteor-head-sparkle,
  .illu-city .meteor-glow-sparkle {
    animation: none;
  }
  .illu-city .twinkle {
    opacity: 0.5;
  }
  .illu-city .city-meteor {
    opacity: 0;
  }
}

/* ──────────────────────────────────────────────────────────────────────
   LAB - Realistic chemistry lab with parallax
   ────────────────────────────────────────────────────────────────────── */

/* Ceramic tile wall with animated green vertical stripes (user's favorite!) */
.illu-lab .lab-wall {
  fill: url(#labTiles);
}

.illu-lab .lab-tile-v {
  animation: stripeShift 3s ease-in-out infinite;
}

@keyframes stripeShift {
  0%, 100% {
    opacity: 0.08;
    transform: translateX(0);
  }
  50% {
    opacity: 0.15;
    transform: translateX(1px);
  }
}

/* Shelf and glassware */
.illu-lab .lab-shelf {
  fill: url(#shelfGrad);
}

.illu-lab .lab-flask {
  transition: fill 0.3s ease;
}

.illu-lab .lab-tube {
  transition: fill 0.3s ease;
}

/* Beaker glass with highlight */
.illu-lab .lab-rim {
  fill: rgba(255,255,255,0.25);
}

.illu-lab .lab-glass {
  fill: rgba(255,255,255,0.06);
  stroke: rgba(160,210,255,0.45);
  mask: url(#glassSpec);
}

/* Liquid inside beaker */
.illu-lab .lab-liquid {
  fill: rgba(0, 255, 224, 0.24);
  stroke: rgba(0, 255, 224, 0.4);
}

/* Rising bubbles */
.illu-lab .lab-bubble {
  fill: rgba(160, 210, 255, 0.95);
  animation: rise 2.8s ease-in infinite;
}

/* Burner flame - opacity flicker only */
.illu-lab .lab-flame {
  fill: rgba(255, 196, 64, 0.85);
  animation: flameFlicker 1.2s ease-in-out infinite;
}

@keyframes flameFlicker {
  0%, 100% {
    opacity: 0.85;
  }
  25% {
    opacity: 0.95;
  }
  50% {
    opacity: 0.75;
  }
  75% {
    opacity: 0.9;
  }
}

/* Animated green stripes - USER'S FAVORITE! */
.illu-lab .lab-stripe {
  animation: stripeGlow 3s ease-in-out infinite;
}

@keyframes stripeGlow {
  0%, 100% {
    opacity: 0.15;
  }
  50% {
    opacity: 0.35;
    fill: rgba(0, 255, 180, 0.35);
  }
}

/* Glowing liquid */
.illu-lab .lab-liquid-glow {
  animation: liquidPulse 2s ease-in-out infinite;
}

@keyframes liquidPulse {
  0%, 100% {
    opacity: 0.6;
  }
  50% {
    opacity: 0.9;
  }
}

/* Microscope light beam animation */
.illu-lab .lab-micro-light {
  animation: microBeamPulse 2s ease-in-out infinite;
}

@keyframes microBeamPulse {
  0%, 100% {
    opacity: 0.3;
  }
  50% {
    opacity: 0.7;
  }
}


/* Molecular structures */
.illu-lab .lab-molecule {
  animation: moleculeFloat 8s ease-in-out infinite;
}

.illu-lab .lab-atom-center {
  fill: #4db8ff;
  stroke: #2d98df;
  stroke-width: 2;
  opacity: 0.9;
}

.illu-lab .lab-atom {
  fill: #6dcbff;
  stroke: #4db8ff;
  stroke-width: 1.5;
  opacity: 0.85;
}

.illu-lab .lab-bond {
  stroke: #5ac3ff;
  stroke-width: 2;
  opacity: 0.7;
}

@keyframes moleculeFloat {
  0%, 100% {
    transform: translateY(0) rotate(0deg);
  }
  50% {
    transform: translateY(-15px) rotate(5deg);
  }
}

/* DNA Helix */
.illu-lab .lab-dna {
  opacity: 0.7;
}

.illu-lab .lab-dna-spine {
  fill: #40c0e0;
  opacity: 0.9;
}

.illu-lab .lab-dna-pair {
  stroke: #60d0f0;
  stroke-width: 2;
  opacity: 0.6;
}

/* Microscope */
.illu-lab .lab-micro-base {
  fill: #2a3842;
  stroke: #3a4852;
  stroke-width: 1;
}

.illu-lab .lab-micro-stand,
.illu-lab .lab-micro-tube {
  fill: #3a4a56;
  stroke: #4a5a66;
  stroke-width: 1.5;
}

.illu-lab .lab-micro-stage {
  fill: #4a5a66;
  opacity: 0.9;
}

.illu-lab .lab-micro-eye,
.illu-lab .lab-micro-lens {
  fill: #1a2a36;
  stroke: #5ac3ff;
  stroke-width: 2;
  opacity: 0.9;
}

.illu-lab .lab-light-beam {
  fill: #ffeb99;
  opacity: 0.4;
  filter: blur(2px);
  animation: beamPulse 2s ease-in-out infinite;
}

@keyframes beamPulse {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 0.7; }
}

/* Energy particles */
.illu-lab .lab-particle {
  fill: #80e0ff;
  opacity: 0.8;
  animation: particleDrift 4s ease-in-out infinite;
}

@keyframes particleDrift {
  0%, 100% {
    transform: translateY(0);
    opacity: 0.8;
  }
  50% {
    transform: translateY(-20px);
    opacity: 0.4;
  }
}

/* Petri dish */
.illu-lab .lab-petri {
  fill: rgba(180, 220, 240, 0.15);
  stroke: #90c8e0;
  stroke-width: 2;
  opacity: 0.9;
}

.illu-lab .lab-colony {
  fill: #ff9080;
  opacity: 0.7;
}

/* Spectrum analyzer */
.illu-lab .lab-spectrum {
  fill: #4de0a0;
  opacity: 0.75;
  animation: spectrumPulse 2s ease-in-out infinite;
}

@keyframes spectrumPulse {
  0%, 100% {
    opacity: 0.3;
    transform: scaleY(0.8);
  }
  50% {
    opacity: 0.9;
    transform: scaleY(1.1);
  }
}

@keyframes rise {
  from {
    transform: translateY(0);
    opacity: 0;
  }
  20% {
    opacity: 0.95;
  }
  to {
    transform: translateY(-80px);
    opacity: 0;
  }
}

@keyframes labShimmer {
  0%, 100% {
    opacity: 0.4;
    transform: scaleX(1);
  }
  50% {
    opacity: 0.7;
    transform: scaleX(1.1);
  }
}

@media (prefers-reduced-motion: reduce) {
  .illu-lab .lab-bubble,
  .illu-lab .lab-flame,
  .illu-lab .lab-tile-v,
  .illu-lab .lab-molecule,
  .illu-lab .lab-light-beam,
  .illu-lab .lab-particle,
  .illu-lab .lab-spectrum {
    animation: none;
  }
  .illu-lab .lab-bubble {
    opacity: 0.5;
  }
  .illu-lab .lab-flame {
    opacity: 0.7;
  }
  .illu-lab .lab-tile-v {
    opacity: 0.08;
  }
}

/* ──────────────────────────────────────────────────────────────────────
   Air (Emotion) SVG - Floating emotion elements
   ────────────────────────────────────────────────────────────────────── */

.illu-air {
  opacity: 1.0; /* Full opacity so elements are visible */
  z-index: 10 !important; /* ABOVE visualization */
  position: absolute !important;
  top: 0 !important; /* At the very top of section */
  height: 150px !important; /* Only top portion */
}

/* Floating hearts */
.illu-air .air-heart {
  animation: floatHeart 8s ease-in-out infinite;
  opacity: 0.9 !important; /* Ensure hearts are very visible */
}

@keyframes floatHeart {
  0%, 100% {
    transform: translateY(0) rotate(0deg);
    opacity: 0.7;
  }
  50% {
    transform: translateY(-30px) rotate(10deg);
    opacity: 0.9;
  }
}

/* Musical notes */
.illu-air .air-note {
  animation: floatNote 6s ease-in-out infinite;
  opacity: 0.85 !important; /* Much more visible */
}

@keyframes floatNote {
  0%, 100% {
    transform: translateY(0) translateX(0);
  }
  33% {
    transform: translateY(-20px) translateX(10px);
  }
  66% {
    transform: translateY(-10px) translateX(-10px);
  }
}

/* Breath ripples */
.illu-air .air-breath {
  opacity: 0.8 !important;
}

.illu-air .air-breath circle {
  animation: breathExpand 4s ease-out infinite;
  stroke-opacity: 0.7;
}

@keyframes breathExpand {
  0% {
    transform: scale(0.8);
    opacity: 0.7;
  }
  50% {
    transform: scale(1.2);
    opacity: 0.4;
  }
  100% {
    transform: scale(1.5);
    opacity: 0;
  }
}

/* Floating leaves - transition from forest */
.illu-air .air-leaf {
  animation: leafDrift 10s ease-in-out infinite;
  opacity: 0.75 !important; /* More visible */
}

@keyframes leafDrift {
  0%, 100% {
    transform: translateY(0) translateX(0) rotate(0deg);
  }
  25% {
    transform: translateY(-15px) translateX(20px) rotate(45deg);
  }
  50% {
    transform: translateY(-25px) translateX(0px) rotate(90deg);
  }
  75% {
    transform: translateY(-15px) translateX(-20px) rotate(135deg);
  }
}

/* Energy flow lines */
.illu-air .air-flow {
  animation: energyPulse 5s ease-in-out infinite;
  stroke-dasharray: 10 5;
  stroke-dashoffset: 0;
  opacity: 0.6 !important; /* Much more visible */
}

@keyframes energyPulse {
  0%, 100% {
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dashoffset: -30;
  }
}

@media (prefers-reduced-motion: reduce) {
  .illu-air .air-heart,
  .illu-air .air-note,
  .illu-air .air-breath circle,
  .illu-air .air-leaf,
  .illu-air .air-flow {
    animation: none;
  }
  .illu-air .air-heart {
    opacity: 0.9 !important;
  }
  .illu-air .air-note {
    opacity: 0.85 !important;
  }
}

@media (prefers-reduced-motion: reduce) {
  .illu-forest .forest-bird {
    animation: none;
  }
}